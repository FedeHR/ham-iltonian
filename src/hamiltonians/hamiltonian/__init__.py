"""
General Hamiltonian class and utilities.
"""